# AI Call Center Analysis API - Mock Server

Welcome to the AI Call Center Analysis API! This repository contains the backend server that provides transcription and AI-powered analysis for customer service calls.

This document is a guide for **front-end developers** to get the mock server running locally, understand the API contract, and start building the client-side application.

## Table of Contents
1. [What This API Does](#1-what-this-api-does)
2. [Quick Start: Running the Mock Server](#2-quick-start-running-the-mock-server)
3. [The API Contract: Your Guide](#3-the-api-contract-your-guide)
4. [The End-to-End Workflow](#4-the-end-to-end-workflow)
5. [Testing with the Console Client](#5-testing-with-the-console-client)

---

### 1. What This API Does

The API provides a simple, asynchronous workflow to analyze audio files. The core process is:
1.  A client **uploads** a local audio file or provides a public URL.
2.  The API accepts the request and returns a **Job ID**.
3.  The client **polls** a status endpoint using the Job ID until the analysis is complete.
4.  The final result includes a full transcription, speaker separation, a summary, sentiment analysis, and a list of action items.

---

### 2. Quick Start: Running the Mock Server

The server is fully containerized with Docker, so you don't need to install Python or any dependencies locally.

#### Prerequisites
*   [Docker Desktop](https://www.docker.com/products/docker-desktop/) installed and running on your machine.

#### Steps to Run:
1.  **Clone this repository:**
    ```bash
    git clone [your-repository-url]
    cd [repository-folder]
    ```

2.  **Build and Run with Docker Compose:** Open a terminal in the project root and run the following command:
    ```bash
    docker-compose up --build
    ```
    Docker will build the image and start the server. You will see Uvicorn startup logs in your terminal.

3.  **Verify the Server is Running:**
    Once the server is running, open your web browser and navigate to:
    **[http://localhost:8000/docs](http://localhost:8000/docs)**

    You should see the interactive Swagger UI documentation for the API.

---

### 3. The API Contract: Your Guide

The single source of truth for all API endpoints, request bodies, and response schemas is the **interactive documentation** generated by the server.

➡️ **[http://localhost:8000/docs](http://localhost:8000/docs)** ⬅️

Here, you can:
*   See all available endpoints (`/v1/uploads`, `/v1/jobs`, etc.).
*   View the exact JSON structure for request and response bodies.
*   **Execute API calls directly from your browser** to test the endpoints.

The formal contract is also defined in the `openapi.yaml` file in this repository.

---

### 4. The End-to-End Workflow

Your front-end application will follow this sequence:

1.  **(If using a local file) `POST /v1/uploads`**:
    *   Send a local audio file using `multipart/form-data`.
    *   The server will respond with a `201 Created` status and a JSON body containing a temporary `uploadUrl`.
    *   Example Response: `{ "uploadUrl": "http://localhost:8000/v1/files/some-uuid.mp3" }`

2.  **`POST /v1/jobs`**:
    *   Send a JSON request body with a list of URLs to be analyzed. These can be public URLs or the `uploadUrl` from the previous step.
    *   Example Request: `{ "audioUrls": ["http://localhost:8000/v1/files/some-uuid.mp3"] }`
    *   The server immediately responds with `202 Accepted` and a JSON body containing the `id` of the newly created job.

3.  **`GET /v1/jobs/{jobId}`**:
    *   Poll this endpoint periodically (e.g., every 5-10 seconds) using the `id` from the previous step.
    *   Check the `status` field in the response. It will be `queued`, `processing`, or `completed`.
    *   When the status is `completed`, the `results` field will be populated with the full analysis data.

---

### 5. Testing with the Console Client

This repository includes a simple console-based Python client (`client.py`) that demonstrates the full end-to-end workflow. You can use it as a reference for how to interact with the API.

#### To Run the Client:
1.  Make sure the mock server is running in one terminal.
2.  (Optional) Set up a Python virtual environment and install dependencies: `pip install -r requirements.txt`.
3.  Open `client.py` and update the `LOCAL_AUDIO_FILE` variable to point to a test audio file on your machine.
4.  In a **new terminal**, run the client:
    ```bash
    python client.py
    ```
    You will see a step-by-step log of the client uploading a file, submitting a job, polling for results, and printing the final report.
